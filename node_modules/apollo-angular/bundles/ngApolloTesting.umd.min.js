!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?o(exports,require("apollo-angular"),require("apollo-link"),require("apollo-cache-inmemory"),require("apollo-cache"),require("@angular/core"),require("graphql"),require("apollo-client")):"function"==typeof define&&define.amd?define("apollo-angular/testing",["exports","apollo-angular","apollo-link","apollo-cache-inmemory","apollo-cache","@angular/core","graphql","apollo-client"],o):o(((e=e||self)["apollo-angular"]=e["apollo-angular"]||{},e["apollo-angular"].testing={}),e["apollo-angular"],e.apolloLink.core,e.apollo.cache.inmemory,e.apolloCache,e.ng.core,e.graphql,e.apollo)}(this,(function(e,o,t,r,n,i,a,p){"use strict";var c=function(){},l=function(e){return e&&e.hasOwnProperty("graphQLErrors")},u=function(){function e(e,o){this.operation=e,this.observer=o}return e.prototype.flush=function(e){l(e)?this.observer.error(e):(this.observer.next(e),this.observer.complete())},e.prototype.networkError=function(e){var o=new p.ApolloError({networkError:e});this.flush(o)},e.prototype.graphqlErrors=function(e){this.flush({errors:e})},e}(),s=function(){function e(){this.open=[]}return e.prototype.handle=function(e){var o=this;return new t.Observable((function(t){var r=new u(e,t);o.open.push(r)}))},e.prototype._match=function(e){var o=this;return"string"==typeof e?this.open.filter((function(o){return o.operation.operationName===e})):"function"==typeof e?this.open.filter((function(o){return e(o.operation)})):this.isDocumentNode(e)?this.open.filter((function(o){return a.print(o.operation.query)===a.print(e)})):this.open.filter((function(t){return o.matchOp(e,t)}))},e.prototype.matchOp=function(e,o){var t=JSON.stringify(e.variables),r=JSON.stringify(e.extensions),n=this.compare(e.operationName,o.operation.operationName),i=this.compare(t,o.operation.variables),p=a.print(o.operation.query)===a.print(e.query),c=this.compare(r,o.operation.extensions);return n&&i&&p&&c},e.prototype.compare=function(e,o){var t,r="string"==typeof(t=o)?t:JSON.stringify(t);return!e||r===e},e.prototype.match=function(e){var o=this,t=this._match(e);return t.forEach((function(e){var t=o.open.indexOf(e);-1!==t&&o.open.splice(t,1)})),t},e.prototype.expectOne=function(e,o){o=o||this.descriptionFromMatcher(e);var t=this.match(e);if(t.length>1)throw new Error('Expected one matching operation for criteria "'+o+'", found '+t.length+" operations.");if(0===t.length)throw new Error('Expected one matching operation for criteria "'+o+'", found none.');return t[0]},e.prototype.expectNone=function(e,o){o=o||this.descriptionFromMatcher(e);var t=this.match(e);if(t.length>0)throw new Error('Expected zero matching operations for criteria "'+o+'", found '+t.length+".")},e.prototype.verify=function(){var e=this.open;if(e.length>0){var o=e.map((function(e){return e.operation.operationName})).join(", ");throw new Error("Expected no open operations, found "+e.length+": "+o)}},e.prototype.isDocumentNode=function(e){return!e.operationName},e.prototype.descriptionFromMatcher=function(e){return"string"==typeof e?"Match operationName: "+e:"object"==typeof e?this.isDocumentNode(e)?"Match DocumentNode":"Match operation: "+(e.operationName||"(any)")+", variables: "+(JSON.stringify(e.variables)||"(any)"):"Match by function: "+e.name},e}();s.decorators=[{type:i.Injectable}];var f=new i.InjectionToken("apollo-angular/testing cache"),h=new i.InjectionToken("apollo-angular/testing named cache"),y=new i.InjectionToken("apollo-angular/testing named clients");var g=function(e,o,n,i,a){function p(e,n){return{link:new t.ApolloLink((function(t){return o.handle(function(e,o){return o.clientName=e,o}(e,t))})),cache:n||new r.InMemoryCache({addTypename:!1})}}e.create(p("default",i)),n&&n.length&&n.forEach((function(o){var t=a&&"object"==typeof a?a:{};e.createNamed(o,p(o,t[o]))}))};g.decorators=[{type:i.NgModule,args:[{imports:[o.ApolloModule],providers:[s,{provide:c,useExisting:s}]}]}],g.ctorParameters=function(){return[{type:o.Apollo},{type:s},{type:Array,decorators:[{type:i.Optional},{type:i.Inject,args:[y]}]},{type:n.ApolloCache,decorators:[{type:i.Optional},{type:i.Inject,args:[f]}]},{type:void 0,decorators:[{type:i.Optional},{type:i.Inject,args:[h]}]}]};var d=function(){function e(){}return e.withClients=function(e){return{ngModule:g,providers:[{provide:y,useValue:e}]}},e}();d.decorators=[{type:i.NgModule,args:[{imports:[g]}]}],e.APOLLO_TESTING_CACHE=f,e.APOLLO_TESTING_NAMED_CACHE=h,e.ApolloTestingController=c,e.ApolloTestingModule=d,e.TestOperation=u,e.ɵa=y,e.ɵb=g,e.ɵc=s,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ngApolloTesting.umd.min.js.map