{"version":3,"file":"ngApolloBoost.js","sources":["../../src/tokens.ts","../../src/apollo-boost.ts","../../src/apollo-boost-module.ts","../../src/ngApolloBoost.ts"],"names":[],"mappings":"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","sourcesContent":["import {InjectionToken} from '@angular/core';\n\nimport {PresetConfig} from './types';\n\nexport const APOLLO_BOOST_CONFIG = new InjectionToken<PresetConfig>(\n  '[apollo-angular-boost] config',\n);\n","import {Injectable} from '@angular/core';\nimport {ApolloLink, Observable} from 'apollo-link';\nimport {Apollo} from 'apollo-angular';\nimport {HttpLink} from 'apollo-angular-link-http';\nimport {withClientState} from 'apollo-link-state';\nimport {onError} from 'apollo-link-error';\nimport {InMemoryCache} from 'apollo-cache-inmemory';\n\nimport {PresetConfig} from './types';\n\n@Injectable()\nexport class ApolloBoost {\n  constructor(private apollo: Apollo, private httpLink: HttpLink) {}\n\n  public create(config: PresetConfig) {\n    const cache =\n      config && config.cacheRedirects\n        ? new InMemoryCache({cacheRedirects: config.cacheRedirects})\n        : new InMemoryCache();\n\n    const stateLink =\n      config && config.clientState\n        ? withClientState({...config.clientState, cache})\n        : false;\n\n    const errorLink =\n      config && config.onError\n        ? onError(config.onError)\n        : onError(({graphQLErrors, networkError}) => {\n            if (graphQLErrors) {\n              graphQLErrors.map(({message, locations, path}) =>\n                // tslint:disable-next-line\n                console.log(\n                  `[GraphQL error]: Message: ${message}, Location: ${locations}, Path: ${path}`,\n                ),\n              );\n            }\n            if (networkError) {\n              // tslint:disable-next-line\n              console.log(`[Network error]: ${networkError}`);\n            }\n          });\n\n    const requestHandler =\n      config && config.request\n        ? new ApolloLink(\n            (operation, forward) =>\n              new Observable((observer) => {\n                let handle: any;\n                Promise.resolve(operation)\n                  .then((oper) => config.request(oper))\n                  .then(() => {\n                    handle = forward(operation).subscribe({\n                      next: observer.next.bind(observer),\n                      error: observer.error.bind(observer),\n                      complete: observer.complete.bind(observer),\n                    });\n                  })\n                  .catch(observer.error.bind(observer));\n\n                return () => {\n                  if (handle) {\n                    handle.unsubscribe();\n                  }\n                };\n              }),\n          )\n        : false;\n\n    const httpLink = this.httpLink.create({\n      ...((config && config.httpOptions) || {}),\n      uri: (config && config.uri) || '/graphql',\n    });\n\n    const link = ApolloLink.from(\n      [errorLink, requestHandler, stateLink, httpLink].filter(\n        (x) => !!x,\n      ) as ApolloLink[],\n    );\n\n    this.apollo.create({\n      link,\n      cache,\n    });\n  }\n}\n","import {NgModule, Optional, Inject} from '@angular/core';\nimport {ApolloModule} from 'apollo-angular';\nimport {HttpLinkModule} from 'apollo-angular-link-http';\n\nimport {ApolloBoost} from './apollo-boost';\nimport {APOLLO_BOOST_CONFIG} from './tokens';\nimport {PresetConfig} from './types';\n\n@NgModule({\n  imports: [ApolloModule, HttpLinkModule],\n  providers: [ApolloBoost],\n})\nexport class ApolloBoostModule {\n  constructor(\n    boost: ApolloBoost,\n    @Optional()\n    @Inject(APOLLO_BOOST_CONFIG)\n    config?: PresetConfig,\n  ) {\n    if (config) {\n      boost.create(config);\n    }\n  }\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"]}